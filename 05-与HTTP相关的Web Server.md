## 第五章 与HTTP相关的Web Server

### 5.1 Virtual Host

HTTP/1.1允许一台主机搭建多个web server，多个域名映射的是同一个ip。

### 5.2 通信数据转发

#### 5.2.1 代理

代理：服务端和客户端的中间人程序，客户端请求和服务端响应的转发者

![代理](./images/代理.bmp)

![URI访问控制](./images/URI访问控制.bmp)

- 缓存代理：预先将资源的副本保存在代理服务器上，当代理再次收到对相同资源请求时，就可以返回缓存的资源副本。

- 透明代理：不对报文做任何修改的代理。

#### 5.2.2 网关

网关：转发其它服务端数据的服务器，能够接收和处理客户端的请求

![网关](./images/网关.bmp)

网关可以提供非HTTP服务，比如：数据库服务等，可以提高服务端的安全性。

#### 5.2.3 隧道

隧道：相隔甚远的客户端和服务端之间的中转，并保持双向连接的应用程序

![隧道通信](./images/隧道通信.bmp)

确保通信的安全性，隧道本身不会解析HTTP请求，它只是报文传递的中转。

### 5.3 保存资源的缓存

缓存：代理服务器或客户端本地磁盘内保存的资源副本。

有了缓存，就可以减少对服务端资源的访问次数，节省了通信流量。

![缓存服务器](./images/缓存服务器.bmp)

缓存的资源也会过期，一般会设定有效期。另外，即使存在缓存，缓存服务器也会向服务器请求，确认资源的有效性。若判断缓存失效，缓存服务器会重新获取新的缓存。

![缓存过期](./images/缓存过期.bmp)

客户端也有缓存，机制和缓存服务器类似。